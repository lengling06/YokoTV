<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YokoTV éƒ¨ç½²ç®¡ç†å™¨</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      padding: 40px;
      width: 100%;
      max-width: 600px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .logo {
      font-size: 32px;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 8px;
    }

    .subtitle {
      color: #666;
      font-size: 16px;
    }

    .section {
      margin-bottom: 30px;
      padding: 20px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      background: #fafafa;
    }

    .section h3 {
      color: #333;
      margin-bottom: 15px;
      font-size: 18px;
    }

    .section p {
      color: #666;
      margin-bottom: 15px;
      line-height: 1.5;
    }

    .command-box {
      background: #2d3748;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 6px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 14px;
      margin: 10px 0;
      position: relative;
      overflow-x: auto;
    }

    .copy-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #4a5568;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }

    .copy-btn:hover {
      background: #2d3748;
    }

    .btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      margin: 5px;
      transition: background 0.3s;
    }

    .btn:hover {
      background: #5a67d8;
    }

    .btn-secondary {
      background: #718096;
    }

    .btn-secondary:hover {
      background: #4a5568;
    }

    .status-indicator {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-running {
      background: #48bb78;
    }

    .status-stopped {
      background: #f56565;
    }

    .status-unknown {
      background: #ed8936;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #333;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid #d0d0d0;
      border-radius: 4px;
      font-size: 14px;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
    }

    .alert {
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 20px;
    }

    .alert-info {
      background: #e6f3ff;
      color: #0066cc;
      border-left: 4px solid #0066cc;
    }

    .alert-success {
      background: #f0fff4;
      color: #065f46;
      border-left: 4px solid #10b981;
    }

    .alert-warning {
      background: #fffbeb;
      color: #92400e;
      border-left: 4px solid #f59e0b;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <div class="logo">ğŸ¬ YokoTV</div>
      <div class="subtitle">éƒ¨ç½²ç®¡ç†å™¨</div>
    </div>

    <!-- å¿«é€Ÿéƒ¨ç½² -->
    <div class="section">
      <h3>ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èï¼‰</h3>
      <p>ä½¿ç”¨é¢„æ„å»ºçš„ Docker é•œåƒï¼Œæœ€å¿«æœ€ç®€å•çš„éƒ¨ç½²æ–¹å¼</p>

      <div class="form-group">
        <label for="imageTag">é€‰æ‹©ç‰ˆæœ¬:</label>
        <select id="imageTag">
          <option value="latest">latest (æœ€æ–°ç‰ˆ)</option>
          <option value="v1.0.0">v1.0.0</option>
          <option value="stable">stable</option>
        </select>
      </div>

      <div class="command-box">
        <button class="copy-btn" onclick="copyCommand('quickDeploy')">å¤åˆ¶</button>
        <div id="quickDeploy">
          # 1. ä¸‹è½½æ›´æ–°è„šæœ¬<br>
          curl -fsSL https://raw.githubusercontent.com/MoonTechLab/LunaTV/main/scripts/update.sh -o update.sh<br>
          chmod +x update.sh<br><br>
          # 2. æ‰§è¡Œæ›´æ–°<br>
          ./update.sh <span id="selectedTag">latest</span>
        </div>
      </div>

      <button class="btn" onclick="generateQuickDeploy()">ç”Ÿæˆå‘½ä»¤</button>
    </div>

    <!-- ä¸€é”®éƒ¨ç½² -->
    <div class="section">
      <h3>ğŸ“¦ å®Œæ•´éƒ¨ç½²</h3>
      <p>ä¸‹è½½å®Œæ•´æºç å¹¶éƒ¨ç½²ï¼Œé€‚åˆé¦–æ¬¡å®‰è£…</p>

      <div class="command-box">
        <button class="copy-btn" onclick="copyCommand('fullDeploy')">å¤åˆ¶</button>
        <div id="fullDeploy">
          # ä¸‹è½½å¹¶æ‰§è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬<br>
          curl -fsSL https://raw.githubusercontent.com/MoonTechLab/LunaTV/main/scripts/deploy.sh | bash
        </div>
      </div>

      <button class="btn" onclick="copyCommand('fullDeploy')">å¤åˆ¶å‘½ä»¤</button>
    </div>

    <!-- æ‰‹åŠ¨éƒ¨ç½² -->
    <div class="section">
      <h3>ğŸ”§ æ‰‹åŠ¨éƒ¨ç½²</h3>
      <p>é€‚åˆéœ€è¦è‡ªå®šä¹‰é…ç½®çš„é«˜çº§ç”¨æˆ·</p>

      <div class="command-box">
        <button class="copy-btn" onclick="copyCommand('manualDeploy')">å¤åˆ¶</button>
        <div id="manualDeploy">
          # 1. ä¸‹è½½æºç <br>
          wget https://github.com/MoonTechLab/LunaTV/archive/refs/heads/main.zip<br>
          unzip main.zip<br>
          cd LunaTV-main<br><br>
          # 2. é…ç½®ç¯å¢ƒ<br>
          cp .env.example .env<br>
          nano .env<br><br>
          # 3. å¯åŠ¨æœåŠ¡<br>
          docker-compose up -d
        </div>
      </div>

      <button class="btn" onclick="copyCommand('manualDeploy')">å¤åˆ¶å‘½ä»¤</button>
    </div>

    <!-- æœåŠ¡ç®¡ç† -->
    <div class="section">
      <h3>âš™ï¸ æœåŠ¡ç®¡ç†</h3>
      <p>å¸¸ç”¨çš„æœåŠ¡ç®¡ç†å‘½ä»¤</p>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
        <button class="btn btn-secondary" onclick="copyToClipboard('docker-compose ps')">æŸ¥çœ‹çŠ¶æ€</button>
        <button class="btn btn-secondary" onclick="copyToClipboard('docker-compose logs -f')">æŸ¥çœ‹æ—¥å¿—</button>
        <button class="btn btn-secondary" onclick="copyToClipboard('docker-compose restart')">é‡å¯æœåŠ¡</button>
        <button class="btn btn-secondary" onclick="copyToClipboard('docker-compose down')">åœæ­¢æœåŠ¡</button>
      </div>
    </div>

    <!-- çŠ¶æ€ä¿¡æ¯ -->
    <div class="alert alert-info">
      <strong>ğŸ’¡ æç¤º:</strong>
      <ul style="margin-top: 10px; padding-left: 20px;">
        <li>é¦–æ¬¡éƒ¨ç½²å»ºè®®ä½¿ç”¨"å®Œæ•´éƒ¨ç½²"</li>
        <li>æ—¥å¸¸æ›´æ–°æ¨èä½¿ç”¨"å¿«é€Ÿéƒ¨ç½²"</li>
        <li>éƒ¨ç½²å®Œæˆåè®¿é—® <code>http://localhost:3000</code></li>
        <li>é»˜è®¤ç”¨æˆ·å/å¯†ç åœ¨ <code>.env</code> æ–‡ä»¶ä¸­é…ç½®</li>
      </ul>
    </div>
  </div>

  <script>
    // æ›´æ–°æ ‡ç­¾é€‰æ‹©
    document.getElementById('imageTag').addEventListener('change', function () {
      document.getElementById('selectedTag').textContent = this.value;
    });

    // ç”Ÿæˆå¿«é€Ÿéƒ¨ç½²å‘½ä»¤
    function generateQuickDeploy() {
      const tag = document.getElementById('imageTag').value;
      document.getElementById('selectedTag').textContent = tag;
    }

    // å¤åˆ¶å‘½ä»¤åˆ°å‰ªè´´æ¿
    function copyCommand(elementId) {
      const element = document.getElementById(elementId);
      const text = element.textContent.replace(/\n/g, '\n').replace(/<br>/g, '\n');
      copyToClipboard(text);
    }

    // å¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿
    function copyToClipboard(text) {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
          showToast('å‘½ä»¤å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!');
        });
      } else {
        // å…¼å®¹è€æµè§ˆå™¨
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        showToast('å‘½ä»¤å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!');
      }
    }

    // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
    function showToast(message) {
      const toast = document.createElement('div');
      toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #48bb78;
                color: white;
                padding: 12px 20px;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                z-index: 1000;
                font-size: 14px;
            `;
      toast.textContent = message;
      document.body.appendChild(toast);

      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transition = 'opacity 0.3s';
        setTimeout(() => document.body.removeChild(toast), 300);
      }, 2000);
    }

    // æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼ˆå¦‚æœåœ¨åŒä¸€æœåŠ¡å™¨ï¼‰
    async function checkServiceStatus() {
      try {
        const response = await fetch('/health');
        if (response.ok) {
          return 'running';
        }
      } catch (e) {
        // å¿½ç•¥é”™è¯¯
      }
      return 'unknown';
    }
  </script>
</body>

</html>